# Доменная модель

## Модель данных. Entity Relation Diagram
![erd.svg](https://flatura.github.io/fastmbo_docs/docs/uml/erd.svg)

## Требования к структуре данных:

1. Все идентификаторы сущностей — UUID (или другой уникальный тип).
2. Все поля с текстом (имя, описание, обоснование, комментарий) — ограничены по длине (например, 255/1024/2048 символов), поддерживают только валидный UTF-8.
3. Все поля email, логин — валидируются по шаблону, уникальность проверяется в системе.
4. Пароль хранится только в зашифрованном (BCrypt/SHA-256 и т.п.) виде, не менее 8 символов.
5. Файлы достижений:
   1. Допустимые типы: PDF, JPG, PNG, DOCX (другие только при явном расширении требований).
   2. Максимальный размер — 10 МБ.
6. Метрика/достижение не может быть изменена после наступления определённого статуса (read-only после валидации/завершения периода).
7. Все поля, влияющие на бизнес-логику (баллы, статусы, периоды) — должны быть защищены от прямого редактирования через UI (только валидированные формы).
8. Для всех действий, приводящих к изменению состояния сущности, обязательно сохранять дату и идентификатор пользователя (created_by, created_at, modified_by, modified_at).
9. Удаление реализовано как soft-delete (is_deleted=true), чтобы сохранять историю и связность данных.
10. Для каждой сущности должны быть определены обязательные и опциональные поля.

## Ограниченные контексты

1. Ролевая модель 
   1. users - Пользователи
   2. groups - Группы
2. Система оценки
   1. periods - Периоды
   2. performance_lists - Оценочные листы
   3. metric_types - Шаблоны метрик
   4. achievements_types - Шаблоны достижений
   5. metric_аfacts - Экземпляры метрик
   6. achievements_facts - Экземпляры достижений
   7. manual_point_adjustments - Факты корректировок (дополнительные премиальные по решению администрации)
3. Логи
   1. audit_log - записи логов

## Жизненный цикл сущностей

### Метрика
- `на заполнение` → создаётся и редактируется.
- `заполнена` → фиксируется при старте периода, более не изменяется.

### Достижение
- `новое` → создано сотрудником.
- `на валидации` → ожидает решения руководителя.
- `подтверждено` → зачтено и учитывается в премии.
- `отклонено` → не участвует в расчётах.
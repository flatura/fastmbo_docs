# 02_FUNCTIONAL_REQUIREMENTS

## 1. Описание функциональных модулей

### 1.1 Отчетные периоды
- Создание нового отчетного периода. Период виден только администрации;
- Указание стимулирующего фонда для периода;
- Запуск периода. Период становится видим всем сотрудникам;
- Завершение периода с блокировкой изменений;
- Архивация периода. Период пропадает у всех пользователей кроме администрации;
- Экспорт периода (экспорт всех метрик, достижений, вложений и результатов);
- Удаление периода с высвобождением занятого вложениями места.

### 1.2. Оценочные листы
- Администрация может создавать, редактировать и удалять оценочные листы
- Каждый оценочный лист содержит следующие поля:
  - Название листа
  - На какие должности распространяется лист
  - В каких отчетных периодах действует
  - Какие метрики содержит
  - Экземпляры достижений каких типов можно добавлять сотруднику, имеющему должность с этим оц.листом
- Редактировать оц.лист можно только тогда, когда он входит в период, который ещё не активен. Если активен или завершен, редактировать нельзя.
- Администрация может дублировать оценочные листы, чтобы вносить изменения и прикреплять к новым периодам

### 1.3 Метрики
- Добавление, редактирование и удаление метрик до запуска периода;
- Каждая метрика содержит:
    - название, описание;
    - диапазон веса (min/max);
    - период действия;
    - группы сотрудников, к которым она применяется.
- Метрики становятся неизменяемыми после начала периода.

### 1.4 Достижения
- Администрация может создавать, редактировать и удалять типы достижений
- Тип достижения абстрактен и содержит следующие поля:
    - имя типа достижения (например, "Грамота федерального уровня");
    - диапазон баллов (минимум и максимум);
    - текстовое описание условий получения максимума или минимума баллов;
- Сотрудник может добавлять экземпляр достижения, указав:
    - тип достижения;
    - обоснование (текст);
    - прикреплённый файл (до 10 МБ);
    - число баллов в пределах допустимого диапазона.
- После добавления достижение получает статус "на валидации";
- Руководитель видит достижения своих подчинённых;
- Возможность подтвердить или отклонить каждое достижение;
- Подтверждение переводит достижение в статус "подтверждено";
- Отклонение — в статус "отклонено";
- Комментарий при отклонении — опционален.

### 1.5 Расчёт премий
- Расчёт запускается администратором после завершения периода.
- Для каждого сотрудника рассчитывается:
    - сумма баллов;
    - доля от общего фонда;
    - итоговая премия.
- Баллы, фонд и результат фиксируются и становятся read-only.

### 1.6 Пользователи
- У администратора системы должна быть возможность добавлять, редактировать и удалять пользователей системы
- У учетной записи пользователя должны быть следующие обязательные поля:
  - Имя
  - Фамилия
  - Отчество
  - Логин в системе
  - Пароль
  - Должность
  - Подразделение
  - Не
- Привязка руководителей к подчинённым (один к нескольким, и наоборот).

### 1.7 Должности
- У заместителей директора, директора и администратора системы должна быть возможность создавать, редактировать и удалять должности

### 1.8 Журналирование действий
- Все действия логируются:
    - создание и редактирование метрик;
    - добавление и изменение достижений;
    - подтверждение и отклонение;
    - завершение периода и расчёт премий.
- Журнал доступен администраторам и заместителям.

### 1.9 Просмотр и экспорт данных
- Доступ к информации ограничен ролью:
    - сотрудник — свои достижения;
    - руководитель — достижения подчинённых;
    - заместитель и администратор — все данные.
- Экспорт таблиц в Excel.
- PDF экспорт — только клиентский (через браузер).

## 2. Жизненный цикл сущностей

### 2.1 Метрика
- `на заполнение` → создаётся и редактируется.
- `заполнена` → фиксируется при старте периода, более не изменяется.

### 2.2 Достижение
- `новое` → создано сотрудником.
- `на валидации` → ожидает решения руководителя.
- `подтверждено` → зачтено и учитывается в премии.
- `отклонено` → не участвует в расчётах.

## 3. Ролевая модель
### 3.1. Роли в системе
- В системе должны быть предусмотрены следующие роли:
  - сотрудник
  - заместитель директора
  - директор
  - администратор системы.

### 3.2. Доступы ролей

| Доступ\Роль        |        Сотрудник         |        Заместитель        |                        Директор                        |     Администратор системы     |
|:------------------:|:------------------------:|:-------------------------:|:------------------------------------------------------:|:-----------------------------:|
| Просмотр пользователей | Только себя и подчиенных | Только себя и подчиенных  |                          Всех                          | Всех                         |
| Создание пользователей |            -             |             -             |                           -                            | Да                           |
| Редактирование пользователей |       Только себя        |    Только свой профиль    | Только свой профиль + Выстраивание иерархии подчинения | Всех                         |
| Удаление пользователей |            -             |             -             |                           -                            | Да (soft-delete)             |
| Смена пароля           |       Только себя        |             -             |                           -                            | Любому пользователю           |
| Управление ролями      |            -             |             -             |          Да, кроме роли Администратор сситемы          | Да                           |
| Назначение руководителей |            -             |            Да             |                           Да                           | Да                           |
| Просмотр оценочных листов |       Только свой        |        Подчинённых        |                          Всех                          | Всех                         |
| Изменение оценочных листов |       Только свой        | Подчинённых (ограниченно) |                          Всех                          | Всех                         |
| Просмотр метрик/достижений |       Только свои        |        Подчинённых        |                          Всех                          | Всех                         |
| Ввод/изменение метрик/достижений |       Только свои        |             -             |                          Всех                          | Всех                         |
| Согласование метрик/достижений |            -             |        Подчинённых        |                          Всех                          | Всех                         |
| Просмотр логов/аудита     |            -             |             -             |                           Да                           | Да (полный доступ)           |
| Экспорт данных           |           Нет            |             -             |                           Да                           | Да                           |
| Запуск периода           |            -             |             -             |                           Да                           | Да                           |
| Завершение периода       |            -             |             -             |                           Да                           | Да                           |
| Премиальный фонд (настройка/просмотр) |            -             |             -             |                           Да                           | Да                           |


## 3. Ограничения и проверки
- Достижение не может быть создано без файла.
- Вес достижения должен попадать в min/max метрики.
- Только руководитель может подтверждать достижения подчинённых.
- Изменения недоступны после завершения периода.
- Только директор может завершить период и инициировать расчёт.

## 4. Требования к интерфейсу

- Максимум 2–3 клика до любой ключевой функции.
- Термины должны быть однозначны: "метрика", "достижение", "период", "баллы", "премия".
- Интерфейс адаптируется под малые экраны.
